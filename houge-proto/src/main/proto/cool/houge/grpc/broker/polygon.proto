syntax = "proto3";
option java_package = "cool.houge.grpc.broker";
option java_outer_classname = "PolygonPb";

message BrokerAuthRequest {
  // 访问令牌
  string token = 1;
}

message BrokerAuthResponse {
  // 用户ID
  int64 uid = 1;
}

message BrokerListGidsRequest {
  int64 uid = 1;
}

message BrokerListGidsResponse {
  repeated int64 gid = 1;
}

message BrokerPacketRequest {
  // 发起请求的用户ID
  int64 request_uid = 1;
  // Packet数据
  bytes data_bytes = 2;
  // 过滤终端的标识
  string filter = 9;
}

message BrokerPacketResponse {
  // 响应结果数据
  bytes data_bytes = 1;
}

service Polygon {

  // JWT 用户认证
  rpc Auth(BrokerAuthRequest) returns(BrokerAuthResponse) {}

  // 查询用户的群组ID列表
  rpc ListGids(BrokerListGidsRequest) returns(BrokerListGidsResponse) {}

  // 处理 Packet
  rpc ProcessPacket(BrokerPacketRequest) returns(BrokerPacketResponse) {}
}
